import { StyledLink } from '@/components/styled-link'
import { Tabs } from 'nextra/components';
import { Callout } from 'nextra/components'

# Public channel

Public channels should be used for publicly accessible data as they do not require any form of authorization in order to be subscribed to.

You can subscribe and unsubscribe from channels at any time. Thereâ€™s no need to wait for the Channels to finish connecting first.

## Subscribe

Create a subscription to a specific channel. Provide any required parameters for public, private or presence channels.

```ts
const sub = wskit.channel('chats', { type:'public' })
```

## Unsubscribe

Stop receiving events and clear all listeners from the subscription.

```ts
sub.dispose();
```

## Events

### Listen for an event

Subscribe to a specific event on the channel.

```ts
sub.on('messageReceived', (event) => {
  console.log(event.message);
})
```

### Stop listening for an event

<Callout type="important">
This should only be used when you want to stop listening for a specific event without unsubscribing from the channel; otherwise, calling `sub.dispose()` is sufficient.
</Callout>

Remove a specific listener using either the returned unsubscribe function or the original callback reference.

<Tabs items={['Using returned unsubscribe function', 'Using original callback reference']}>
  <Tabs.Tab>
    ```ts
    const unsub = sub.on('messageReceived', (event) => {
      console.log(event.message);
    })

    // Later
    unsub();
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```ts
    const messageReceivedHandler = (event) => {
      console.log(event);
    };

    sub.on('messageReceived', messageReceivedHandler)

    // Later
    sub.off(messageReceivedHandler);
    ```
  </Tabs.Tab>
</Tabs>

## Notifications

### Listen for a notification

Listen for `.Illuminate\\Notifications\\Events\\BroadcastNotificationCreated` event on a channel.

```ts
sub.notification((notif) => {
  console.log(notif)
});
```

### Stop listening for a notification

<Callout type="important">
  This should only be used when you want to stop listening for a specific event without unsubscribing from the channel; otherwise, calling `sub.dispose()` is sufficient.
</Callout>

<Tabs items={['Using returned unsubscribe function']}>
  <Tabs.Tab>
    ```ts
    // Using returned unsubscribe function
    const unsub = sub.notification((notif) => {
      console.log(notif)
    });

    unsub()
    ```
  </Tabs.Tab>
</Tabs>

## Internal Events

### Subscription succeeded

Triggered when the subscription is successfully established.

```ts
sub.subscribed(() => {
  /** Do something after successful subscription **/
})
```